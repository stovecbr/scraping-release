# 動作確認済の環境
  - OS : Windows
  - ブラウザ: Google Chrome
    - バージョン : 128.0.6613.114

# 使用方法
## 1. scraping-release.zip をダウンロードして展開しておく
- 「scraping-release.zip」のファイル構成
   - **scraping-release/**
     - **dist/**
       - `chromedriver.exe`
       - `gui.exe`
       - `scraper.py`
       - `send_to_sheets.py`          
      
## 2. Google Sheets APIの設定
Google Sheets APIを使用する際、サービスアカウントを作成する必要があります。サービスアカウントには、特定のリソースやAPIにアクセスするための認証情報が含まれています。以下に、サービスアカウント名とIDの詳細、およびサービスアカウントの作成手順を説明します。

### サービスアカウントとは？

サービスアカウントは、Google Cloud内の仮想ユーザーです。特定のプロジェクトやAPIへのアクセス権を持ち、アプリケーションやコンテナがGoogle Cloudリソースにアクセスするために使用されます。サービスアカウントには、次のような情報が含まれます：

- **サービスアカウント名**：人間が理解しやすい名前で、サービスアカウントを識別するために使用されます。
- **サービスアカウントID**：サービスアカウントを一意に識別するIDで、通常は電子メール形式です。

### サービスアカウントの作成手順

#### 1. Google Cloud Consoleにアクセス

- **Google Cloud Console**にアクセスします：[Google Cloud Console](https://console.cloud.google.com/)

#### 2. プロジェクトの選択または作成

- 既存のプロジェクトを選択するか、新しいプロジェクトを作成します。

#### 3. APIとサービス

- ナビゲーションメニューから**「APIとサービス」**を選択し、**「認証情報」**をクリックします。

#### 4. サービスアカウントの作成

1. **「認証情報を作成」**ボタンをクリックし、**「サービスアカウント」**を選択します。
2. サービスアカウントの名前を入力します。名前は人間が理解しやすいもので構いません。例えば、`coconala-scraper-service-account`。
3. サービスアカウントIDは自動的に生成されますが、必要に応じて編集できます。このIDは電子メール形式で表示されます（例：`coconala-scraper-service-account@<project-id>.iam.gserviceaccount.com`）。
4. **「作成して続行」**をクリックします。

#### 5. サービスアカウントに役割を割り当てる

- サービスアカウントに適切な役割を割り当てます。Google Sheets APIにアクセスするためには**「エディター」**の役割を割り当てることをお勧めします。
- **「続行」**をクリックします。

#### 6. サービスアカウントのキーを作成

1. **「鍵」**タブに移動します。
2. **「鍵を追加」** > **「新しい鍵を作成」**をクリックします。
3. キータイプとして**「JSON」**を選択し、**「作成」**をクリックします。
4. 自動的に`credentials.json`ファイルがダウンロードされます。このファイルは後で使用するため、安全な場所に保管してください。

### サービスアカウントの使用

1. **credentials.json**の名前を**scraping_credentials.json**に変更します。
1. scraping-release.zip をダウンロードして展開しておく」で展開した「dist」ディレクトリに配置します。
1. スプレッドシートの共有設定で、サービスアカウントのメールアドレス（サービスアカウントID）を追加して、「編集者」の権限を付与します。

## 3. スクレイピングの実行
   - スプレッドシートのシート名を「sheet1」にします。
   - gui.exe をダブルクリックします。
   - スプレッドシートIDを入力して「スクレイピングの実行🐱」ボタンをクリックします。
   - スプレッドシートにデータが自動で入力されます。